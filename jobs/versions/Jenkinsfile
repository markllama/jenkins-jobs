@Library('art')
import com.redhat.art.Version
import com.redhat.art.VersionTest

import groovy.util.GroovyTestSuite 
import junit.framework.Test 
import junit.textui.TestRunner

properties(
    [
        buildDiscarder(
            logRotator(
                artifactDaysToKeepStr: '',
                artifactNumToKeepStr: '',
                daysToKeepStr: '',
                numToKeepStr: '1000')),
        [
            $class: 'ParametersDefinitionProperty',
            parameterDefinitions: [
                // where to run the build. This really should be done by
                // tagging the job and a set of agent nodes to match
                [
                    name: 'TARGET_NODE',
                    description: 'Jenkins agent node',
                    $class: 'hudson.model.StringParameterDefinition',
                    defaultValue: 'container'
                ],
            ]
        ]
    ]
)

node(TARGET_NODE) {

    checkout scm

    echo "Loading version library"
    

    //echo "Loading version library tests"
    //def tests = load("jobs/versions/version_test.groovy")
    
    stage("test versions") {
        echo "BEGIN TESTING"

        vt = new VersionTest(this)

        vt.test_constructor()
        vt.test_pad()
        vt.test_cmp()

        //vt.test_increments()
        
        echo "END TESTING"

        echo "START Creating v0"
        v0 = new Version("3.2.1")
        echo "END Creating v0"
        echo "hello0: " + v0.toString()
        echo "hello1: ${v0.toString()}"
        hello2 = "hello2:" + v0
        echo "hello2.size() = ${hello2.size()}"
        echo hello2

        v0_string = string v0
        echo "v0_string.size() = ${v0_string.size()}"
        echo "v0_string(inline) = ${v0_string}"
        echo "v0_string(concat) = " v0_string
        
        echo "START Creating v1"
        v1 = new Version("3.9.2")
        echo "END Creating v1"

    }
    //echo "v0 = ${v0_string}"
}
